function save(){$("#modalCargando").modal();var e=$("input[name=_token]").val();$("#button-save").prop("disabled",!0),$.ajax({url:subfolder+"/update_rol",headers:{"X-CSRF-TOKEN":e},type:"post",data:{user:$("#selectuser").val().split("_")[0],rol:$("#tiporol").val()},success:function(e){$("#modalCargando").modal("hide"),"success"==e.response?print_message("Rol Actualizado con Exito",subfolder+"/set_rol",1):print_message("Actualizacion de Rol Fallida",subfolder+"/set_rol",2)}})}function update_permisos(){$("#modalCargando").modal();var e,o,a=[];$("input[type=radio]:checked").each(function(e){o={id_permiso:$(this).attr("name"),value:$(this).val()},a.push(o)}),e=JSON.stringify(a);var t=$("input[name=_token]").val();$("#button-save").prop("disabled",!0),$.ajax({url:subfolder+"/permiso_update",headers:{"X-CSRF-TOKEN":t},type:"POST",data:{idRol:rol_uni,array:e},success:function(e){$("#modalCargando").modal("hide"),"success"==e.response?print_message("Permisos Actualizados con Exito",subfolder+"/edit_permisos",1):print_message("Actualizacion de Permisos Fallida",subfolder+"/edit_permisos",2)}})}function print_message(e,o,a){setTimeout(function(){toastr.options={closeButton:!0,progressBar:!1,positionClass:"toast-top-center",showMethod:"slideDown",timeOut:4e3},1==a&&toastr.success(e),2==a&&toastr.error(e)},1300),setTimeout(function(){window.location=o},2600)}$("body").change(".toggle",function(e){var o=$("#"+e.target.id),a=$("input[name=_token]").val();void 0!==$(o).prop("checked")&&($("#modalCargando").modal(),$.ajax({url:subfolder+"/centro_user_update",type:"POST",data:{_token:a,user:$("#selectuser").val().split("_")[0],centro:$(o).data("idcentro"),value:$(o).prop("checked")},success:function(e){o.parents("td").attr("data-order",$(o).prop("checked")?1:0),swal(e.titulo,e.msg,"success"),setTimeout(function(){$("#modalCargando").modal("hide")},1e3)},error:function(e,o,a){swal("Ocurrio un error!","Porfavor intente de nuevo","error"),setTimeout(function(){$("#modalCargando").modal("hide")},1e3)}}))});var rol_uni=0;$("#divuser").on("change","#selectuser",function(){$("#modalCargando").modal(),$("#div-rol").show(),$("#div-proyectos").show(),$("#rol_desc").html("Rol Actual: "+$("#selectuser").val().split("_")[1]),$("#details_centros_user").empty();var e=$("input[name=_token]").val();$.ajax({url:subfolder+"/centros_user",headers:{"X-CSRF-TOKEN":e},type:"GET",data:{user:$("#selectuser").val().split("_")[0]},success:function(e){if($("#modalCargando").modal("hide"),null!=e.centros_user){var o='<table class="datatable compact dt-center" cellspacing="0" width="100%">';o+="<thead><tr><th>Estado</th><th>Centro</th></tr></thead><tfoot><tr><th>Estado</th><th>Centro</th></tr></tfoot><tbody>",$.each(e.centros_user,function(e,a){o+="<tr>",o+='<td align="center" data-order="`+value.assign+`"><div class="checkbox"><label><input class="toggle" type="checkbox" id="checkbox-'+a.id+'" data-nombre="'+a.name+'" data-idcentro="'+a.id+'" '+(1==a.assign?"checked":"")+' data-toggle="toggle"></label></div></td>',o+="<td>"+a.name+"</td>",o+="</tr>"}),$("#details_centros_user").append(o),$(".toggle").bootstrapToggle(),$(".datatable").DataTable()}}})}),$("#div-rol").on("change","#tiporol",function(){$("#div-save-usuario-rol").show()}),$("#div-selectrol").on("change","#selectrol",function(){$("#modalCargando").modal(),$("#details_roles").empty(),$("#div-guardar-edit").show();var e=$("input[name=_token]").val();rol_uni=$("#selectrol").val(),$.ajax({url:subfolder+"/permisos",headers:{"X-CSRF-TOKEN":e},type:"GET",data:{rol:rol_uni},success:function(e){if($("#modalCargando").modal("hide"),null!=e.permisos){var o='<div class="form-group col-sm-9"><b>Opci√≥n</b></div><div class="form-group col-sm-3"><b>Ver</b></div>',a="";$.each(e.permisos,function(e,t){a!==t.description&&(o+="<h1>"+t.description+"</h1>",a=t.description),o+='<div class="form-group col-sm-9">',o+=t.name,o+='</div><div class="form-group col-sm-3 divDetail">',0==t.assign?(o+=' Si <input type="radio" name="'+t.id+'" value="si">',o+=' No <input type="radio" name="'+t.id+'" value="no" checked="checked"><br>'):(o+=' Si <input type="radio" name="'+t.id+'" value="si" checked="checked">',o+=' No <input type="radio" name="'+t.id+'" value="no"><br>'),o+="</div>"}),$("#details_roles").append(o)}}})});