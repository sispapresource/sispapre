{"version":3,"sources":["rol.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"rol.js","sourcesContent":["$('body').change('.toggle',function(event){\n    var me = $(\"#\"+event.target.id);\n    var token = $('input[name=_token]').val();\n    if($(me).prop('checked') !== undefined){\n        $(\"#modalCargando\").modal();    \n        $.ajax({\n            url:  subfolder+\"/centro_user_update\",\n            type: \"POST\",\n            data: {\n                _token: token,\n                user:$('#selectuser').val().split('_')[0],\n                centro: $(me).data('idcentro'),\n                value: $(me).prop('checked')\n            },\n            success: function (res) {\n                me.parents('td').attr('data-order',$(me).prop('checked')? 1: 0);\n                swal(res.titulo, res.msg, \"success\");\n                setTimeout(function(){\n                    $('#modalCargando').modal('hide');\n                },1000);\n                \n            },\n            error: function (xhr, ajaxOptions, thrownError) {\n                swal(\"Ocurrio un error!\", \"Porfavor intente de nuevo\", \"error\");\n                setTimeout(function(){\n                    $('#modalCargando').modal('hide');\n                },1000);\n            }\n        });                 \n    }\n});\nvar rol_uni=0;\n$(\"#divuser\").on(\"change\", \"#selectuser\", function(){ // Blade Usuarios\n    $(\"#modalCargando\").modal();\n    $(\"#div-rol\").show();\n    $(\"#div-proyectos\").show();\n    $('#rol_desc').html('Rol Actual: '+$('#selectuser').val().split('_')[1]);\n    $('#details_centros_user').empty();\n    var token = $('input[name=_token]').val();\n   \n    $.ajax({\n        url: subfolder +'/centros_user',\n        headers: {'X-CSRF-TOKEN': token},\n        type: 'GET',\n        data:  {user:$('#selectuser').val().split('_')[0]},\n        success:  function(resp){\n            $('#modalCargando').modal('hide');\n            if(resp.centros_user != null){\n                var html='<table class=\"datatable compact dt-center\" cellspacing=\"0\" width=\"100%\">';\n                html += '<thead><tr><th>Estado</th><th>Centro</th></tr></thead><tfoot><tr><th>Estado</th><th>Centro</th></tr></tfoot><tbody>';\n                $.each(resp.centros_user, function (key, value) {\n                    html+=\"<tr>\";\n                    html+='<td align=\"center\" data-order=\"`+value.assign+`\"><div class=\"checkbox\"><label><input class=\"toggle\" type=\"checkbox\" id=\"checkbox-'+value.id+'\" data-nombre=\"'+value.name+'\" data-idcentro=\"'+value.id+'\" '+ (value.assign==1? \"checked\" : \"\") +' data-toggle=\"toggle\"></label></div></td>';\n                    html+=\"<td>\"+value.name+\"</td>\";\n                    html+=\"</tr>\";\n                });\n                $('#details_centros_user').append(html);\n                $('.toggle').bootstrapToggle();\n                $('.datatable').DataTable();\n                \n            }\n        }\n    });\n});\n$(\"#div-rol\").on(\"change\", \"#tiporol\", function(){ // Blade Usuarios\n    $(\"#div-save-usuario-rol\").show();\n});\n$(\"#div-selectrol\").on(\"change\", \"#selectrol\", function(){ // Blade Roles\n    $(\"#modalCargando\").modal();\n    $('#details_roles').empty();\n    $(\"#div-guardar-edit\").show();\n    var token = $('input[name=_token]').val();\n    rol_uni=$('#selectrol').val();\n    $.ajax({\n        url: subfolder +'/permisos',\n        headers: {'X-CSRF-TOKEN': token},\n        type: 'GET',\n        data:  {rol:rol_uni},\n        success:  function(resp){\n            $('#modalCargando').modal('hide');\n            if(resp.permisos != null){\n                var html='<div class=\"form-group col-sm-9\"><b>Opci√≥n</b></div><div class=\"form-group col-sm-3\"><b>Ver</b></div>';\n                var header = \"\";\n                $.each(resp.permisos, function (key, value) {   \n                    if(header !== value.description){\n                        html+='<h1>'+value.description+'</h1>';\n                        header=value.description;\n                    }\n                    html+='<div class=\"form-group col-sm-9\">';         \n                    html+=value.name;\n                    html+='</div><div class=\"form-group col-sm-3 divDetail\">';\n                    if(value.assign==0){\n                        html+=' Si <input type=\"radio\" name=\"'+value.id+'\" value=\"si\">';\n                        html+=' No <input type=\"radio\" name=\"'+value.id+'\" value=\"no\" checked=\"checked\"><br>';\n                    }\n                    else{\n                        html+=' Si <input type=\"radio\" name=\"'+value.id+'\" value=\"si\" checked=\"checked\">';\n                        html+=' No <input type=\"radio\" name=\"'+value.id+'\" value=\"no\"><br>';\n                    }\n                    html+='</div>';\n                });\n                $('#details_roles').append(html);\n            }\n        }\n    });\n});\nfunction save(){ // Assign rol to user\n    $(\"#modalCargando\").modal();\n    var token = $('input[name=_token]').val();\n    $(\"#button-save\").prop('disabled', true);\n    $.ajax({\n        url: subfolder +'/update_rol',\n        headers: {'X-CSRF-TOKEN': token},\n        type: 'post',\n        data:  {user:$('#selectuser').val().split('_')[0],rol:$('#tiporol').val()},\n        success:  function(response){\n            $('#modalCargando').modal('hide');\n            if(response['response']==\"success\")\n                print_message('Rol Actualizado con Exito', subfolder + '/set_rol',1);\n            else\n                print_message('Actualizacion de Rol Fallida', subfolder +'/set_rol',2);\n        }\n    });\n};\nfunction update_permisos(){ // Update permissions to determinate rol\n    $(\"#modalCargando\").modal();\n    var updates=[];\n    var jsonString, item_a;\n    $(\"input[type=radio]:checked\").each(function (index){  \n        item_a = {\n            id_permiso: $(this).attr('name'),\n            value: $(this).val()\n        };\n        updates.push(item_a);\n    }); \n    jsonString = JSON.stringify(updates);\n    var token = $('input[name=_token]').val();\n    $(\"#button-save\").prop('disabled', true);\n    $.ajax({\n        url: subfolder +'/permiso_update',\n        headers: {'X-CSRF-TOKEN': token},\n        type: 'POST',\n        data:  {idRol:rol_uni,array:jsonString},\n        success:  function(response){\n            $('#modalCargando').modal('hide');\n            if(response['response']==\"success\")\n                print_message('Permisos Actualizados con Exito',subfolder +'/edit_permisos',1);\n            else\n                print_message('Actualizacion de Permisos Fallida',subfolder +'/edit_permisos',2);\n        }\n    });\n};\n/* function update_centros_user(){ // Update permissions to determinate rol\n    $(\"#modalCargando\").modal(); \n    var updates=[];\n    var jsonString, item_a;\n    $(\"input[type=radio]:checked\").each(function (index){  \n        item_a = {\n            id_centro: $(this).attr('name'),\n            value: $(this).val()\n        };\n        updates.push(item_a);\n    }); \n    jsonString = JSON.stringify(updates);\n    var token = $('input[name=_token]').val();\n    $(\"#button-update\").prop('disabled', true);\n    $.ajax({\n        url: subfolder +'/centro_user_update',\n        headers: {'X-CSRF-TOKEN': token},\n        type: 'POST',\n        data:  {idUser:$('#selectuser').val().split('_')[0],array:jsonString},\n        success:  function(response){\n            $('#modalCargando').modal('hide');\n            if(response['response']==\"success\")\n                print_message('Proyectos Actualizados con Exito',subfolder +'/set_rol',1);\n            else\n                print_message('Actualizacion de Proyectos Fallida',subfolder +'/set_rol',2);\n        }\n    });\n}; */\nfunction print_message(msj,location,type){\n    setTimeout(function(){\n        toastr.options = {\n            closeButton: true,\n            progressBar: false,\n            positionClass: \"toast-top-center\",\n            showMethod: 'slideDown',\n            timeOut: 4000\n        };\n        if(type==1)\n            toastr.success(msj);\n        if(type==2)\n            toastr.error(msj);\n    }, 1300);\n    setTimeout(function(){\n        window.location=location;\n    }, 2600);\n}"]}