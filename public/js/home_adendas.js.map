{"version":3,"sources":["home_adendas.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"home_adendas.js","sourcesContent":["/*  var t_costo = t_utilidad = t_admin = t_subtotal = t_itbms = t_total = 0;\n\n$(document).ready(function () {\n\n    $(\"#modalCargando\").modal();\n\n    var mydata = [];\n\n    var  token, url, data;\n    token = $('input[name=_token]').val();\n\n    $.ajax({\n        url: subfolder +'/adendas',\n        headers: {'X-CSRF-TOKEN': token},\n        type: 'GET',\n        datatype: 'JSON',\n        success: function (resp) {\n\n            $('#modalCargando').modal('hide');\n            if(resp.adendas != null){\n                $('#noregister').hide();\n                $.each(resp.adendas, function (key, value) {\n                    item = {}\n                    item [\"id\"] = value.id_adenda;\n                    item [\"note\"] = value.proyecto;\n                    item [\"tax\"] = value.fecha_documento;\n                    item [\"nro_adenda\"] = value.nro_adenda;\n                    item [\"descripcion\"] = value.descripcion;\n                    item [\"monto_adenda\"] = value.monto;\n                    item [\"utilidad\"] = value.utilidad;\n                    item [\"admin\"] = value.admin;\n                    item [\"subtotal\"] = value.subtotal;\n                    item [\"itbms\"] = value.itbms;\n                    item [\"total\"] = value.total;\n                    item [\"estado\"] = value.estado;\n                    if(value.monto)\n                        t_costo += parseFloat(value.monto);\n                    if(value.utilidad)\n                        t_utilidad += parseFloat(value.utilidad);\n                    if(value.admin)\n                        t_admin += parseFloat(value.admin);\n                    if(value.subtotal)\n                        t_subtotal += parseFloat(value.subtotal);\n                    if(value.itbms)\n                        t_itbms += parseFloat(value.itbms);\n                    if(value.total)\n                        t_total += parseFloat(value.total);\n                    mydata.push(item);\n                });\n\n                // Configuration for jqGrid Example 1\n                $(\"#table_list_6\").jqGrid({\n                    data: mydata,\n                    datatype: \"local\",\n                    height: 660,\n                    autowidth: true,\n                    shrinkToFit: true,\n                    rowNum: 20,\n                    rowList: [20, 40, 60],\n                    colNames: ['Proyecto', 'No. de documento', 'Fecha de doc.', 'Descripcion', 'Costo','Utilidad','Admin.','Subtotal','ITBMS','Total','Estado', 'Opciones'],\n                    colModel: [\n                        {name: 'note', index: 'note', width: 340, sortable: true, align: 'left'},\n                        {name: 'nro_adenda', index: 'nro_adenda', width: 150, align: \"right\", align: 'center', formatter:'showlink', formatoptions:{baseLinkUrl:subfolder +'/adenda_detail', idName:'idAdenda'}},\n                        {name: 'tax', index: 'tax', width: 120, sorttype: \"date\", formatter: \"date\", formatoptions : {srcformat : 'Y-m-d H:i',newformat : 'd/m/Y'},align: 'center'},\n                        {name: 'descripcion', index: 'descripcion', width: 320, sorttype: \"date\",align: 'center'},\n                        {name: 'monto_adenda', index: 'monto_adenda', width: 110, formatter:'currency', formatoptions:{decimalSeparator:\".\", thousandsSeparator: \",\", decimalPlaces: 2, prefix: \"$\"}, sorttype: \"float\", align: 'right'},\n                        {name: 'utilidad', index: 'utilidad', width: 110, formatter:'currency', formatoptions:{decimalSeparator:\".\", thousandsSeparator: \",\", decimalPlaces: 2, prefix: \"$\"}, sorttype: \"float\", align: 'right'},\n                        {name: 'admin', index: 'admin', width: 110, formatter:'currency', formatoptions:{decimalSeparator:\".\", thousandsSeparator: \",\", decimalPlaces: 2, prefix: \"$\"}, sorttype: \"float\", align: 'right'},\n                        {name: 'subtotal', index: 'subtotal', width: 110, formatter:'currency', formatoptions:{decimalSeparator:\".\", thousandsSeparator: \",\", decimalPlaces: 2, prefix: \"$\"}, sorttype: \"float\", align: 'right'},\n                        {name: 'itbms', index: 'itbms', width: 110, formatter:'currency', formatoptions:{decimalSeparator:\".\", thousandsSeparator: \",\", decimalPlaces: 2, prefix: \"$\"}, sorttype: \"float\", align: 'right'},\n                        {name: 'total', index: 'total', width: 110, formatter:'currency', formatoptions:{decimalSeparator:\".\", thousandsSeparator: \",\", decimalPlaces: 2, prefix: \"$\"}, sorttype: \"float\", align: 'right'},\n                        {name: 'estado', index: 'estado', width: 90, align: 'center'},\n                        {name: 'name', index: 'name', width: 90, align: 'center'}                    \n                    ],\n                    pager: \"#pager_list_6\",\n                    viewrecords: true,\n                    gridComplete: function() {\n                        var grid = $(\"#table_list_6\");\n                        var ids = grid.jqGrid('getDataIDs');\n                        for (var i = 0; i < ids.length; i++) {\n                            var rowId = ids[i];\n                            var checkOut = '<a data-toggle=\"modal\" class=\"btn-primary btn-sm\" style=\"color:white;\" onclick=\"loadModal('+rowId+')\">Opciones</a>';\n                            grid.jqGrid('setRowData', rowId, { name: checkOut });\n                        }\n                    },\n                    hidegrid: false,\n                    scrollOffset: 0\n                });\n                // add totales\n                $(\"#table_list_6_monto_adenda\").append('<h6>Total: '+toCurrency(t_costo)+'</h6>');\n                $(\"#table_list_6_utilidad\").append('<h6>Total: '+toCurrency(t_utilidad)+'</h6>');\n                $(\"#table_list_6_admin\").append('<h6>Total: '+toCurrency(t_admin)+'</h6>');\n                $(\"#table_list_6_subtotal\").append('<h6>Total: '+toCurrency(t_subtotal)+'</h6>');\n                $(\"#table_list_6_itbms\").append('<h6>Total: '+toCurrency(t_itbms)+'</h6>');\n                $(\"#table_list_6_total\").append('<h6>Total: '+toCurrency(t_total)+'</h6>');\n            }\n        }\n    });\n\n    //Add responsive to jqGrid\n    $(window).bind('resize', function () {\n        var width = $('.jqGrid_wrapper').width();\n        $('#table_list_6').setGridWidth(width);\n    });\n    $(\"#UploadLinkModal\").click(function(){\n        $('#modal-form').modal('toggle');\n        $('#modal-upload').modal();\n    });\n    \n});\n\nfunction reload(action){\n\n    if(action == 'clear'){\n        $('#textFilter').val('');\n        $('#dateFilter').val('');\n    }\n\n    $(\"#modalCargando\").modal();\n\n    var mydata = [];\n    var t_costo = t_utilidad = t_admin = t_subtotal = t_itbms = t_total = 0;\n\n    var token = $('input[name=_token]').val();\n\n    filterText = $('#textFilter').val();\n    filterText1 = $('#select-estados').val();\n    filterText2 = $('#dateFilter').val();\n    filterText3 = $('#numeroFilter').val();\n\n    $.ajax({\n        url: subfolder +'/adendas',\n        headers: {'X-CSRF-TOKEN': token},\n        type: 'GET',\n        data: {'textFilter':filterText,'estadoFilter':filterText1, 'dateFilter':filterText2,'numeroFilter':filterText3},\n        datatype: 'JSON',\n        success: function (resp) {\n\n            $('#modalCargando').modal('hide');\n\n            if(resp.adendas != null){\n                $.each(resp.adendas, function (key, value) {\n                    item = {}\n                    item [\"id\"] = value.id_adenda;\n                    item [\"note\"] = value.proyecto;\n                    item [\"tax\"] = value.fecha_documento;\n                    item [\"nro_adenda\"] = value.nro_adenda;\n                    item [\"descripcion\"] = value.descripcion;\n                    item [\"monto_adenda\"] = value.monto;\n                    item [\"utilidad\"] = value.utilidad;\n                    item [\"admin\"] = value.admin;\n                    item [\"subtotal\"] = value.subtotal;\n                    item [\"itbms\"] = value.itbms;\n                    item [\"total\"] = value.total;\n                    item [\"estado\"] = value.estado;\n                    if(value.monto)\n                        t_costo += parseFloat(value.monto);\n                    if(value.utilidad)\n                        t_utilidad += parseFloat(value.utilidad);\n                    if(value.admin)\n                        t_admin += parseFloat(value.admin);\n                    if(value.subtotal)\n                        t_subtotal += parseFloat(value.subtotal);\n                    if(value.itbms)\n                        t_itbms += parseFloat(value.itbms);\n                    if(value.total)\n                        t_total += parseFloat(value.total);\n                    mydata.push(item);\n                });\n            }\n\n            if (mydata === undefined || mydata.length == 0) {\n\n                setTimeout(function() {\n                    toastr.options = {\n                        closeButton: true,\n                        progressBar: false,\n                        positionClass: \"toast-top-center\",\n                        showMethod: 'slideDown',\n                        timeOut: 4000\n                    };\n                    toastr.success('No se encontraron registros');\n                }, 1300);\n\n                //delete totales\n                $(\"#table_list_6_monto_adenda h6\").html('');\n                $(\"#table_list_6_utilidad h6\").html('');\n                $(\"#table_list_6_admin h6\").html('');\n                $(\"#table_list_6_subtotal h6\").html('');\n                $(\"#table_list_6_itbms h6\").html('');\n                $(\"#table_list_6_total h6\").html('');\n\n                jQuery('#table_list_6').jqGrid('clearGridData').trigger('reloadGrid');\n                \n            }else{\n\n                setTimeout(function() {\n                    toastr.options = {\n                        closeButton: true,\n                        progressBar: false,\n                        positionClass: \"toast-top-center\",\n                        showMethod: 'slideDown',\n                        timeOut: 4000\n                    };\n                    if(mydata.length==1)\n                        toastr.success(resp.adendas.length +' Registro encontrado');\n                    if(mydata.length>1)\n                        toastr.success(resp.adendas.length +' Registros encontrados');\n                }, 1300);\n\n                // add totales\n                $(\"#table_list_6_monto_adenda h6\").html('Total: '+toCurrency(t_costo));\n                $(\"#table_list_6_utilidad h6\").html('Total: '+toCurrency(t_utilidad));\n                $(\"#table_list_6_admin h6\").html('Total: '+toCurrency(t_admin));\n                $(\"#table_list_6_subtotal h6\").html('Total: '+toCurrency(t_subtotal));\n                $(\"#table_list_6_itbms h6\").html('Total: '+toCurrency(t_itbms));\n                $(\"#table_list_6_total h6\").html('Total: '+toCurrency(t_total));\n\n                jQuery('#table_list_6').jqGrid('clearGridData')\n                    .jqGrid('setGridParam', {data: mydata})\n                    .trigger('reloadGrid');\n            }\n        }\n    });\n}\n\nfunction toCurrency(value){\n    return \"$\"+value.toFixed(2).replace(/(\\d)(?=(\\d{3})+\\.)/g, '$1,');\n}\n\nfunction loadModal(rowId){\n    var nameProject = jQuery('#table_list_6').jqGrid ('getCell', rowId, 'note');\n    $('#nameProject').html('');\n    $('#nameProject').append(nameProject);\n    $(\"#viewAdendaLinkModal\").attr(\"href\", subfolder +\"/adenda_detail?idAdenda=\"+rowId);\n    $(\"#createAjusteLinkModal\").attr(\"href\", subfolder +\"/ajuste_crear?idAdenda=\"+rowId);\n    $(\"#editAdendaLinkModal\").attr(\"href\", subfolder +\"/adenda_editar?idAdenda=\"+rowId);\n    $(\"#exportAdendaExcel\").attr(\"href\", subfolder +\"/export_adenda/excel/\"+rowId);\n    $(\"#exportAdendaPdf\").attr(\"href\", subfolder +\"/export_adenda/pdf/\"+rowId);\n    $(\"#idAdenda\").val(rowId);\n    $(\"#modal-form\").modal();\n}\n\n//function exportHomeAdendas(){\n//    $(\"#modalCargando\").modal();\n//    var token = $('input[name=_token]').val();\n//    $.ajax({\n//        url: subfolder +'/export_home_adendas',\n//        headers: {'X-CSRF-TOKEN': token},\n//        type: 'POST',\n//        data:  {nombreFilter:$('#textFilter').val(), estadoFilter:$('#select-estados').val()},\n//        success:  function(response){\n//            $('#modalCargando').modal('hide');\n//            window.location.href = subfolder + response;\n//        }\n//    }); \n//} */"]}